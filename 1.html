<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Generator & Search</title>
</head>
<body>
  <button onclick="searchProducts()">Search</button>
  <input type="text" id="searchInput" placeholder="Type 'contains' to search">

  <pre id="products"></pre>
  <div id="time"></div>

  <script>
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateProducts() {
      const startTime = Date.now();
      const products = [];

      for (let i = 0; i < 10000; i++) {
        const product = {
          [`product-${i}`]: {
            published: `product-${getRandomInt(1000, 9999)}`,
            brand: `brand-${getRandomInt(1, 10)}`,
            attributes: {
              size: ["xl", "l", "m", "s"][getRandomInt(0, 3)],
              color: ["white", "black", "blue", "red", "green"][getRandomInt(0, 4)]
            }
          }
        };
        products.push(product);
      }

      const endTime = Date.now();
      const elapsedTime = (endTime - startTime) / 1000; // Convert to seconds

      document.getElementById('products').innerText = JSON.stringify(products, null, 2);
      document.getElementById('time').innerText = `Generated 10000 products in ${elapsedTime} seconds.`;

      return products;
    }

    function searchProducts() {
      const searchWord = document.getElementById('searchInput').value.trim().toLowerCase();
      if (searchWord === 'contains') {
        alert('Please enter a search term other than "contains".');
        return;
      }

      const startTime = Date.now();
      const products = generateProducts();

      let foundProducts = [];
      products.forEach(product => {
        const productKeys = Object.keys(product);
        productKeys.forEach(key => {
          const attributes = product[key].attributes;
          const attributeValues = Object.values(attributes).flat().map(val => val.toLowerCase());
          if (attributeValues.includes(searchWord)) {
            foundProducts.push(product);
          }
        });
      });

      const endTime = Date.now();
      const elapsedTime = (endTime - startTime) / 1000; // Convert to seconds

      document.getElementById('products').innerText = JSON.stringify(foundProducts, null, 2);
      document.getElementById('time').innerText = `Search completed in ${elapsedTime} seconds.`;
    }
  </script>
</body>
</html>
