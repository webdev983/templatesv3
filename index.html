<!-- log format-->
<script>
  const format = 
  {
    "time": "41421412412412",
    "action": [
                "appendChild",
                "insertBefore",
                "innerHtml",
                "removeTag",
                "dublicateTag",
                "changeTag",
                "setAttribute",
                "removeAttribut",
                "innerText"
    ],
    "target-element": "uuid",
    "inserted-element": [
    [{ type: "tag", id: "uuid" }],
    [{ type: "tag", id: "uuid1" }, { type: "tag", id: "uuid2" }],
    [{ type: "component", id: "uuid" }]
    ],
     "inserted-code": "html code for inner html element",
     "tag-change": "div",

    "key": "class",
    "value": "cool-class",
    "text-content":"12421412412414141241"
};
    
</script>

<h2>generated page</h2>

<div id="generated-page">
  <component id="63ae5927-390f-4391-993d-b25ab09c8ada">
  </component>
</div>

<div id="content-grid"  style="display: grid; grid-template-columns: 100% 0%;">

<main>

<h2>builder</h2>
<div id="code-builder" style="position: relative;">
  <button id="aside-toggle" style="font-size: 1.5em; position: absolute; right: 0px; margin-top: -30px">&#8592;log</button>

  <div id="code-tree" style="position: relative;">
    <fieldset id="tagid" data-element="code-tree-tag">
      <legend>💬</legend>
      <input hidden type="checkbox">
      <button data-element="code-tree-show-hide-button">&#8594;</button>
      <button data-element="code-tree-tag-name-button">🏷️component</button>
      <button data-element="code-tree-attributes-button">🔑Attributes</button>
      <button data-element="code-tree-attributes-button">📄Text content</button> 
  </fieldset>
            
   </div>



<!--menus-->
<div hidden>

<!--menu click tag-->
<fieldset id="code-tree-click-tag">
  <legend><button id="code-tree-menu-cancel" onclick = "cancel(event)">❌</button></legend>
            <button id="code-tree-click-tag-append-child" onclick = "append(event)">&#x1F476; append child</button>
            <button  id="code-tree-click-tag-insert-before" onclick = "insertB(event)">&#x2190; insert before</button>       
            <button  id="code-tree-click-tag-inner-html" onclick = "insertHtml(event)">📄 inner HTML</button>       
            <button  id="code-tree-click-tag-change-tag" onclick = "changeTag(event)">✏️ change tag</button>     
            <button  id="code-tree-click-tag-dublicate-tag" onclick = "duplicateTag(event)"> 📄📄 dublicate tag</button>
            <button  id="code-tree-click-tag-remove-tag" onclick = "removeTag(event)">&#128465; remove tag</button>
</fieldset >

<!--menu enter comment-->
<span id="code-tree-tag-comment-form">
  <input placeholder="💬 enter comment" type="text" id="code-tree-tag-comment-input">
  <button id="code-tree-tag-comment-save">💾</button>
  <button id="code-tree-menu-cancel">❌</button>
</span>

<!--menu add element-->
<fieldset id="code-tree-add-tag-step-1">
    <legend><button  id="code-tree-menu-cancel" onclick="cancel(event)">❌</button></legend>
    <button id="code-tree-add-tag-choose-new" onclick = "addNew(event)"> 👶 choose new</button>
    <button  id="code-tree-add-tag-choose-existed" onclick = "addExisting(event)"> 👴 choose existed</button>
    <button  id="code-tree-add-tag-choose-component" onclick = "choseComponent(event)"> 🧩 component</button>
</fieldset>



<!-- menu confirm selected append/insert tags-->
<fieldset id="code-tree-append-or-insert-approv-menu">
  <legend><button id="code-tree-menu-cancel" onclick = "cancel()">❌</button></legend>    
  <span>✅<span id="code-tree-amount-selected-for-append-or-insert" >7</span> selected</span>  
  <button id="code-tree-click-tag-insert-before-approve">&#x1F476; append child</button>
  <button  id="code-tree-click-tag-append-child-approve">&#x2190; insert before</button>    
</fieldset>


<!-- menu to receive inner html -->
<fieldset id="code-tree-inner-html-receive-menu">
<legend><button id="code-tree-menu-cancel" onclick="cancel(event)">❌</button></legend>    
<textarea placeholder="📄inner HTML" id="code-tree-inner-html-receive-textarea" style="min-width: 150px; min-height: 50px; max-width: 90vw;"></textarea>
<br>
<button id="code-tree-inner-html-receiver-save-" onclick ="save(event)">💾 save</button>

</fieldset>

<!--menu to view and edit attributes-->
<div id="code-tree-tag-attributes-form" style="display: flex; flex-direction: column; align-items: flex-end;">
  <table id="code-tree-tag-attributes-list">
    <tr>
      <td><input id="code-tree-tag-attribute-input-key" type="text" placeholder="attribute 🔑" ></td>
      <td><input id="code-tree-tag-attribute-input-key-value" type="text" placeholder="value 📄">
        <button id="code-tree-tag-attribute-add">➕ add</button></td>
      <td><button id="code-tree-menu-cancel" >❌</button></td>
    </tr>

    <tr id="code-tree-tag-attributes-list-item">
      <td>🔑<span id="code-tree-tag-attribute-key">data-type</span></td>
      <td>📄<span id="code-tree-tag-attribute-value">cool product<span></td>
      <td><button id="code-tree-tag-attribute-remove-button">&#128465;</button></td>
      </tr>
    </table>
   </div>
<!--menu choose from tags tabble-->
<fieldset id ="tag-table">
  <legend> <button id="code-tree-menu-cancel" onclick="cancel(event)">❌</button></legend>
  <h2>choose tag</h2>
          <table id="tagsTable" class="tagsTable-style">
            <thead>
              <tr>
                  <th><input type="text" id="searchTagName" placeholder="Search by Tag Name" onkeyup="filterTable(0)"></th>
                  <th><input type="text" id="searchTagValue" placeholder="Search by Tag Value" onkeyup="filterTable(1)"></th>
                  <th><input type="text" id="searchTagType" placeholder="Search by Tag Type" onkeyup="filterTable(2)"></th>
                  <th><input type="text" id="searchTagComment" placeholder="Search by Tag Comment" onkeyup="filterTable(3)"></th>
              </tr>
              <tr>
                  <th>Tag Name</th>
                  <th>Tag Value</th>
                  <th>Tag Type</th>
                  <th>Tag Comment</th>
              </tr>
          </thead>
          <tbody>
          </tbody>
          </table>
</fieldset>
</div>
</main>
<aside style="overflow-y: auto;">
  <span id="last-action-time" style="font-size: 2.2em;"></span>
  <table id="code-log">
    <thead>
      <tr>
          <th style="text-align: left;">🕓time</th>
          <th style="text-align: left;">✔️action</th>
      </tr>
  </thead>
  <tbody id="code-log-body">
      <tr id="code-log-element" hidden>
          <td data-type-code-log="action-time"><span id="code-log-action-time">24.01.01 23:59</span></td>
          <td data-type-code-log="action-name"><span id="code-log-action">append child</span></td>
          <td><button data-type-code-log="action-remove" style="font-size: 1.2em; border: none;">&#128465;</button></td> 
      </tr>
  </tbody>
  
</div>
</aside>
</div>


<!--loading screen-->
<div  id="loading"  style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); display: none; justify-content: center; align-items: center; z-index: 900;">
  <span  style="font-size: 10.2em; color: white;">⏳</span>
  <div id="timer" style="font-size: 2em; color: white;">1.12</div>
</div>


<!--loading script-->
<script>
  /*
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('button').forEach(function(button) {
        button.addEventListener('click', function() {
          const loadingScreen = document.getElementById('loading');
            loadingScreen.style.display = 'flex';

            const timerElement = document.getElementById('timer');
            let tenthsOfSeconds = 0;
            const interval = setInterval(function() {
                tenthsOfSeconds++;
                timerElement.textContent = (tenthsOfSeconds / 10).toFixed(1);
            }, 100);

            const randomTime = Math.random() * 1000 + 100; 

            setTimeout(function() {
                loadingScreen.style.display = 'none';
                clearInterval(interval);

                const lastActionTime = document.getElementById('last-action-time');
                lastActionTime.textContent = timerElement.textContent;
            }, randomTime);
        });
    });
});
*/
</script>


<script>
  var actionLog = []
  function generateUUID() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      const r = Math.random() * 16 | 0,
        v = c === 'x' ? r : (r & 0x3 | 0x8);
      return v.toString(16);
    });
  }
  const pushAction = (e)=>{
    actionLog.push(e)
    executeCommand(e)
    insertDataIntoCodeLog(e.time,e.action)
  }
  function insertDataIntoCodeLog(actionTime, actionName) {
    const originalElement = document.getElementById("code-log-element");
    const clonedElement = originalElement.cloneNode(true);

    // Remove the unwanted button from the cloned element
    const removeButtonCell = originalElement.querySelector("[data-type-code-log='action-remove']");
    if (removeButtonCell) {
      removeButtonCell.parentNode.removeChild(removeButtonCell);
    }

    // Set the content and attributes for the cloned element
    clonedElement.removeAttribute("hidden");
    clonedElement.querySelector("#code-log-action-time").textContent = actionTime;
    clonedElement.querySelector("#code-log-action").textContent = actionName;

    // Get the parent of the original element
    const parent = originalElement.parentNode;

    // Insert the cloned element before the original element
    parent.insertBefore(clonedElement, originalElement);
  }
  const executeCommand = (command)=>{
    //todo
  }
  document.addEventListener('DOMContentLoaded', function () {
    

    async function loader(e, handler) {
      const loadingScreen = document.getElementById('loading');
      loadingScreen.style.display = 'flex';

      const timerElement = document.getElementById('timer');
      let tenthsOfSeconds = 0;
      const interval = setInterval(function () {
        tenthsOfSeconds++;
        timerElement.textContent = (tenthsOfSeconds / 10).toFixed(1);
      }, 100);

      await handler(e);

      loadingScreen.style.display = 'none';
      clearInterval(interval);
      console.log(timerElement.textContent)
      const lastActionTime = document.getElementById('last-action-time');
      lastActionTime.textContent = timerElement.textContent;
    }

    function handleComponentClick(event) {
      const button = event.target.closest('button[data-element="code-tree-tag-name-button"]');
      
      if (button) {
        const parentId = button.parentNode.id;
        const fieldset = document.getElementById('code-tree-click-tag');

        // Check if a cloned fieldset already exists after the parent node
        if (!button.parentNode.nextElementSibling || !button.parentNode.nextElementSibling.id.startsWith('code-tree-click-tag')) {
          // Clone the fieldset node
          const clonedFieldset = fieldset.cloneNode(true);
          
          // Assign a unique id to the cloned fieldset
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          // Insert the cloned fieldset after the parent node of the button
          button.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          
        }
      }
}


    //first menu
    let buttons = document.querySelectorAll('button[data-element="code-tree-tag-name-button"]');
    buttons.forEach(function (button) {
      button.addEventListener('click', e => loader(e, handleComponentClick));
    });


    
  });
  const save =(event)=>{
    const parent = event.target.parentNode
    const {id } = parent
    const action = parent.getAttribute('action')
    console.log('ac' + action)
    if(action ==='innerHtml'){
      const saveButton = event.target;
      const fieldset = saveButton.closest('fieldset');
        
        
      const textareaValue = fieldset.querySelector('#code-tree-inner-html-receive-textarea').value;
            
        
      const el = {
        time: (new Date()).getTime(),
        action,
        target_element:id.split(';')[1],
        insertedCode:textareaValue

      }
      console.log(JSON.stringify(el))
      pushAction(el)
    }
    console.log(JSON.stringify(actionLog))

  }
  
</script>
<script>

  //second menu 
  
  const cancel = (e)=>{
    
    e.target.parentNode.parentNode.remove()
  }
  const append = (e)=>{
    const parentId = e.target.parentNode.id.split(';')[1];
        const fieldset = document.getElementById('code-tree-add-tag-step-1');

        if (!e.target.parentNode.nextElementSibling || !e.target.parentNode.nextElementSibling.id.startsWith('code-tree-add-tag-step-1') ) {
          const clonedFieldset = fieldset.cloneNode(true);
          
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          clonedFieldset.setAttribute('action','Append')
          e.target.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          e.target.parentNode.remove()
        }
  }
  const insertB = (e)=>{
      
      
        const parentId = e.target.parentNode.id.split(';')[1];
        const fieldset = document.getElementById('code-tree-add-tag-step-1');

        if (!e.target.parentNode.nextElementSibling || !e.target.parentNode.nextElementSibling.id.startsWith('code-tree-add-tag-step-1') ) {
          const clonedFieldset = fieldset.cloneNode(true);
          
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          clonedFieldset.setAttribute('action','InsertBefore')
          e.target.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          e.target.parentNode.remove()
        }
      
  }
  const insertHtml = (e)=>{
    
    const parentId = e.target.parentNode.id.split(';')[1];
        const fieldset = document.getElementById('code-tree-inner-html-receive-menu');

        if (!e.target.parentNode.nextElementSibling || !e.target.parentNode.nextElementSibling.id.startsWith('code-tree-inner-html-receive-menu') ) {
          const clonedFieldset = fieldset.cloneNode(true);
          
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          clonedFieldset.setAttribute('action', 'innerHtml')
          e.target.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          e.target.parentNode.remove()
        }
  }
  const changeTag = (e)=>{
    const parentId = e.target.parentNode.id.split(';')[1];
        const fieldset = document.getElementById('tag-table');

        if (!e.target.parentNode.nextElementSibling || !e.target.parentNode.nextElementSibling.id.startsWith('tag-table') ) {
          const clonedFieldset = fieldset.cloneNode(true);

          
          const clonedRows = clonedFieldset.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
          for (let i = 0; i < clonedRows.length; i++) {
            const index = i; // Capture the current value of 'i' in a closure
            clonedRows[i].onclick = function (event) {
              chooseTag(index,event);
            };
          }
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          clonedFieldset.setAttribute('action', 'ChangeTag')
          e.target.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          e.target.parentNode.remove()
        }
  }
  const duplicateTag = (e)=>{
    const parentId = e.target.parentNode.id.split(';')[1];
    const el =    
    {
        time: (new Date()).getTime(),
        action:'dublicateTag',
        target_element:parentId,
        inserted_element:generateUUID()

      }
      pushAction(el)
  }
  const removeTag = (e)=>{
    const parentId = e.target.parentNode.id.split(';')[1];
    const el =    
    {
        time: (new Date()).getTime(),
        action:'removeTag',
        target_element:parentId,

      }
      pushAction(el)
  }

</script>

<!-- tag style-->
<style>
  [data-element="code-tree-tag"] {
  border-bottom: none;
  border-right: none;
}

[data-element="code-tree-tag"] legend {
  user-select: none;
}

[data-element="code-tree-tag"] [data-action="tag-edit-comment"] {
  user-select: none;
}

[data-element="code-tree-tag"] input[type="checkbox"] {
  transform: scale(1.2);
}

[data-element="code-tree-tag"] button {
  font-size: 1.2em;
}

[data-element="code-tree-tag"] [data-element="code-tree-attributes-button"] {
  position: absolute;
  right: 138px;
}

[data-element="code-tree-tag"] [data-element="code-tree-attributes-button"]:last-of-type {
  right: 0px;
}

</style>


<script>

  //third menu 
  const addNew = (e)=>{
    const parentId = e.target.parentNode.id.split(';')[1];
        const fieldset = document.getElementById('tag-table');

        if (!e.target.parentNode.nextElementSibling || !e.target.parentNode.nextElementSibling.id.startsWith('tag-table') ) {
          const clonedFieldset = fieldset.cloneNode(true);
          
          const clonedRows = clonedFieldset.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
          for (let i = 0; i < clonedRows.length; i++) {
            const index = i; // Capture the current value of 'i' in a closure
            clonedRows[i].onclick = function (event) {
              chooseTag(index,event);
            };
          }
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          clonedFieldset.setAttribute('action', e.target.parentNode.getAttribute('action'))
          e.target.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          e.target.parentNode.remove()
        }
  }
  const addExisting = (e)=>{
    const parentId = e.target.parentNode.id.split(';')[1];
        const fieldset = document.getElementById('code-tree-append-or-insert-approv-menu');

        if (!e.target.parentNode.nextElementSibling || !e.target.parentNode.nextElementSibling.id.startsWith('code-tree-append-or-insert-approv-menu') ) {
          const clonedFieldset = fieldset.cloneNode(true);
          
          clonedFieldset.id = clonedFieldset.id  + ';'+parentId;
          clonedFieldset.setAttribute('action', e.target.parentNode.getAttribute('action'))
          e.target.parentNode.insertAdjacentElement('afterend', clonedFieldset);
          e.target.parentNode.remove()
        }
  }
  const choseComponent = (e)=>{

  }
  

</script>


<!-- attributes table style-->
<style>
        
        
  #code-tree-tag-attributes-list  tr:nth-child(odd) {
    background-color: #f0f0f0; 
  }

  #code-tree-tag-attributes-list tr:hover {
    background-color: #dddddd; 
  }
  #code-tree-tag-attributes-list {
    border-collapse: collapse; 
  }

  #code-tree-tag-attributes-list td {
    padding: 7px; 
    word-wrap: break-word; 
  }
</style>
<!-- tags table style-->
<style>
  .tagsTable-style th, .tagsTable-style td {
    padding: 5px;
    text-align: left;
  }
  .tagsTable-style tr:nth-child(even) {
    background-color: #f2f2f2;
  }
  .tagsTable-style input[type="text"] {
    width: 100%;
    box-sizing: border-box;
  }
  .tagsTable-style tr:hover {
    cursor: pointer;
    background-color: #ddd;
  }
  </style>


<!-- tags table script-->
  <script>          const tags = 
  [

{
 "tagName": "txt",
 "tagValue": "<txt></txt>",
 "TagComment": "Contains text content",
 "TagType": "Custom"
},
{
 "tagName": "doctype",
 "tagValue": "<!DOCTYPE>",
 "TagComment": "Defines the document type",
 "TagType": "Basic HTML"
},
{
 "tagName": "html",
 "tagValue": "<html></html>",
 "TagComment": "Defines an HTML document",
 "TagType": "Basic HTML"
},
{
 "tagName": "head",
 "tagValue": "<head></head>",
 "TagComment": "Contains metadata/information for the document",
 "TagType": "Basic HTML"
},
{
 "tagName": "title",
 "tagValue": "<title></title>",
 "TagComment": "Defines a title for the document",
 "TagType": "Basic HTML"
},
{
 "tagName": "body",
 "tagValue": "<body></body>",
 "TagComment": "Defines the document's body",
 "TagType": "Basic HTML"
},
{
 "tagName": "h1",
 "tagValue": "<h1></h1>",
 "TagComment": "Defines HTML headings",
 "TagType": "Basic HTML"
},
{
 "tagName": "h2",
 "tagValue": "<h2></h2>",
 "TagComment": "Defines HTML headings",
 "TagType": "Basic HTML"
},
{
 "tagName": "h3",
 "tagValue": "<h3></h3>",
 "TagComment": "Defines HTML headings",
 "TagType": "Basic HTML"
},
{
 "tagName": "h4",
 "tagValue": "<h4></h4>",
 "TagComment": "Defines HTML headings",
 "TagType": "Basic HTML"
},
{
 "tagName": "h5",
 "tagValue": "<h5></h5>",
 "TagComment": "Defines HTML headings",
 "TagType": "Basic HTML"
},
{
 "tagName": "h6",
 "tagValue": "<h6></h6>",
 "TagComment": "Defines HTML headings",
 "TagType": "Basic HTML"
},
{
 "tagName": "p",
 "tagValue": "<p></p>",
 "TagComment": "Defines a paragraph",
 "TagType": "Basic HTML"
},
{
 "tagName": "br",
 "tagValue": "<br>",
 "TagComment": "Inserts a single line break",
 "TagType": "Basic HTML"
},
{
 "tagName": "hr",
 "tagValue": "<hr>",
 "TagComment": "Defines a thematic change in the content",
 "TagType": "Basic HTML"
},
{
 "tagName": "!--...--",
 "tagValue": "<!--...-->",
 "TagComment": "Defines a comment",
 "TagType": "Basic HTML"
},
{
 "tagName": "abbr",
 "tagValue": "<abbr></abbr>",
 "TagComment": "Defines an abbreviation or an acronym",
 "TagType": "Formatting"
},
{
 "tagName": "address",
 "tagValue": "<address></address>",
 "TagComment": "Defines contact information for the author/owner of a document/article",
 "TagType": "Formatting"
},
{
 "tagName": "b",
 "tagValue": "<b></b>",
 "TagComment": "Defines bold text",
 "TagType": "Formatting"
},
{
 "tagName": "bdi",
 "tagValue": "<bdi></bdi>",
 "TagComment": "Isolates a part of text that might be formatted in a different direction from other text outside it",
 "TagType": "Formatting"
},
{
 "tagName": "bdo",
 "tagValue": "<bdo></bdo>",
 "TagComment": "Overrides the current text direction",
 "TagType": "Formatting"
},
{
 "tagName": "blockquote",
 "tagValue": "<blockquote></blockquote>",
 "TagComment": "Defines a section that is quoted from another source",
 "TagType": "Formatting"
},
{
 "tagName": "cite",
 "tagValue": "<cite></cite>",
 "TagComment": "Defines the title of a work",
 "TagType": "Formatting"
},
{
 "tagName": "code",
 "tagValue": "<code></code>",
 "TagComment": "Defines a piece of computer code",
 "TagType": "Formatting"
},
{
 "tagName": "del",
 "tagValue": "<del></del>",
 "TagComment": "Defines text that has been deleted from a document",
 "TagType": "Formatting"
},
{
 "tagName": "dfn",
 "tagValue": "<dfn></dfn>",
 "TagComment": "Specifies a term that is going to be defined within the content",
 "TagType": "Formatting"
},
{
 "tagName": "em",
 "tagValue": "<em></em>",
 "TagComment": "Defines emphasized text",
 "TagType": "Formatting"
},
{
 "tagName": "i",
 "tagValue": "<i></i>",
 "TagComment": "Defines a part of text in an alternate voice or mood",
 "TagType": "Formatting"
},
{
 "tagName": "ins",
 "tagValue": "<ins></ins>",
 "TagComment": "Defines a text that has been inserted into a document",
 "TagType": "Formatting"
},
{
 "tagName": "kbd",
 "tagValue": "<kbd></kbd>",
 "TagComment": "Defines keyboard input",
 "TagType": "Formatting"
},
{
 "tagName": "mark",
 "tagValue": "<mark></mark>",
 "TagComment": "Defines marked/highlighted text",
 "TagType": "Formatting"
},
{
 "tagName": "meter",
 "tagValue": "<meter></meter>",
 "TagComment": "Defines a scalar measurement within a known range (a gauge)",
 "TagType": "Formatting"
},
{
 "tagName": "pre",
 "tagValue": "<pre></pre>",
 "TagComment": "Defines preformatted text",
 "TagType": "Formatting"
},
{
 "tagName": "progress",
 "tagValue": "<progress></progress>",
 "TagComment": "Represents the progress of a task",
 "TagType": "Formatting"
},
{
 "tagName": "q",
 "tagValue": "<q></q>",
 "TagComment": "Defines a short quotation",
 "TagType": "Formatting"
},
{
 "tagName": "rp",
 "tagValue": "<rp></rp>",
 "TagComment": "Defines what to show in browsers that do not support ruby annotations",
 "TagType": "Formatting"
},
{
 "tagName": "rt",
 "tagValue": "<rt></rt>",
 "TagComment": "Defines an explanation/pronunciation of characters (for East Asian typography)",
 "TagType": "Formatting"
},
{
 "tagName": "ruby",
 "tagValue": "<ruby></ruby>",
 "TagComment": "Defines a ruby annotation (for East Asian typography)",
 "TagType": "Formatting"
},
{
 "tagName": "s",
 "tagValue": "<s></s>",
 "TagComment": "Defines text that is no longer correct",
 "TagType": "Formatting"
},
{
 "tagName": "samp",
 "tagValue": "<samp></samp>",
 "TagComment": "Defines sample output from a computer program",
 "TagType": "Formatting"
},
{
 "tagName": "small",
 "tagValue": "<small></small>",
 "TagComment": "Defines smaller text",
 "TagType": "Formatting"
},
{
 "tagName": "strong",
 "tagValue": "<strong></strong>",
 "TagComment": "Defines important text",
 "TagType": "Formatting"
},
{
 "tagName": "sub",
 "tagValue": "<sub></sub>",
 "TagComment": "Defines subscripted text",
 "TagType": "Formatting"
},
{
 "tagName": "sup",
 "tagValue": "<sup></sup>",
 "TagComment": "Defines superscripted text",
 "TagType": "Formatting"
},
{
 "tagName": "template",
 "tagValue": "<template></template>",
 "TagComment": "Defines a container for content that should be hidden when the page loads",
 "TagType": "Formatting"
},
{
 "tagName": "time",
 "tagValue": "<time></time>",
 "TagComment": "Defines a specific time (or datetime)",
 "TagType": "Formatting"
},
{
 "tagName": "u",
 "tagValue": "<u></u>",
 "TagComment": "Defines some text that is unarticulated and styled differently from normal text",
 "TagType": "Formatting"
},
{
 "tagName": "var",
 "tagValue": "<var></var>",
 "TagComment": "Defines a variable",
 "TagType": "Formatting"
},
{
 "tagName": "wbr",
 "tagValue": "<wbr>",
 "TagComment": "Defines a possible line-break",
 "TagType": "Formatting"
},
{
 "tagName": "form",
 "tagValue": "<form></form>",
 "TagComment": "Defines an HTML form for user input",
 "TagType": "Forms and Input"
},
{
 "tagName": "input",
 "tagValue": "<input>",
 "TagComment": "Defines an input control",
 "TagType": "Forms and Input"
},
{
 "tagName": "textarea",
 "tagValue": "<textarea></textarea>",
 "TagComment": "Defines a multiline input control (text area)",
 "TagType": "Forms and Input"
},
{
 "tagName": "button",
 "tagValue": "<button></button>",
 "TagComment": "Defines a clickable button",
 "TagType": "Forms and Input"
},
{
 "tagName": "select",
 "tagValue": "<select></select>",
 "TagComment": "Defines a drop-down list",
 "TagType": "Forms and Input"
},
{
 "tagName": "optgroup",
 "tagValue": "<optgroup></optgroup>",
 "TagComment": "Defines a group of related options in a drop-down list",
 "TagType": "Forms and Input"
},
{
 "tagName": "option",
 "tagValue": "<option></option>",
 "TagComment": "Defines an option in a drop-down list",
 "TagType": "Forms and Input"
},
{
 "tagName": "label",
 "tagValue": "<label></label>",
 "TagComment": "Defines a label for an <input> element",
 "TagType": "Forms and Input"
},
{
 "tagName": "fieldset",
 "tagValue": "<fieldset></fieldset>",
 "TagComment": "Groups related elements in a form",
 "TagType": "Forms and Input"
},
{
 "tagName": "legend",
 "tagValue": "<legend></legend>",
 "TagComment": "Defines a caption for a <fieldset> element",
 "TagType": "Forms and Input"
},
{
 "tagName": "datalist",
 "tagValue": "<datalist></datalist>",
 "TagComment": "Specifies a list of pre-defined options for input controls",
 "TagType": "Forms and Input"
},
{
 "tagName": "output",
 "tagValue": "<output></output>",
 "TagComment": "Defines the result of a calculation",
 "TagType": "Forms and Input"
},
{
 "tagName": "iframe",
 "tagValue": "<iframe></iframe>",
 "TagComment": "Defines an inline frame",
 "TagType": "Frames"
},
{
 "tagName": "img",
 "tagValue": "<img>",
 "TagComment": "Defines an image",
 "TagType": "Images"
},
{
 "tagName": "map",
 "tagValue": "<map></map>",
 "TagComment": "Defines a client-side image map",
 "TagType": "Images"
},
{
 "tagName": "area",
 "tagValue": "<area>",
 "TagComment": "Defines an area inside an image map",
 "TagType": "Images"
},
{
 "tagName": "canvas",
 "tagValue": "<canvas></canvas>",
 "TagComment": "Used to draw graphics, on the fly, via scripting (usually JavaScript)",
 "TagType": "Images"
},
{
 "tagName": "figcaption",
 "tagValue": "<figcaption></figcaption>",
 "TagComment": "Defines a caption for a <figure> element",
 "TagType": "Images"
},
{
 "tagName": "figure",
 "tagValue": "<figure></figure>",
 "TagComment": "Specifies self-contained content",
 "TagType": "Images"
},
{
 "tagName": "picture",
 "tagValue": "<picture></picture>",
 "TagComment": "Defines a container for multiple image resources",
 "TagType": "Images"
},
{
 "tagName": "svg",
 "tagValue": "<svg></svg>",
 "TagComment": "Defines a container for SVG graphics",
 "TagType": "Images"
},
{
 "tagName": "audio",
 "tagValue": "<audio></audio>",
 "TagComment": "Defines sound content",
 "TagType": "Audio / Video"
},
{
 "tagName": "source",
 "tagValue": "<source>",
 "TagComment": "Defines multiple media resources for media elements (<video>, <audio> and <picture>)",
 "TagType": "Audio / Video"
},
{
 "tagName": "track",
 "tagValue": "<track>",
 "TagComment": "Defines text tracks for media elements (<video> and <audio>)",
 "TagType": "Audio / Video"
},
{
 "tagName": "video",
 "tagValue": "<video></video>",
 "TagComment": "Defines a video or movie",
 "TagType": "Audio / Video"
},
{
 "tagName": "a",
 "tagValue": "<a></a>",
 "TagComment": "Defines a hyperlink",
 "TagType": "Links"
},
{
 "tagName": "link",
 "tagValue": "<link>",
 "TagComment": "Defines the relationship between a document and an external resource (most used to link to style sheets)",
 "TagType": "Links"
},
{
 "tagName": "nav",
 "tagValue": "<nav></nav>",
 "TagComment": "Defines navigation links",
 "TagType": "Links"
},
{
 "tagName": "menu",
 "tagValue": "<menu></menu>",
 "TagComment": "Defines an alternative unordered list",
 "TagType": "Lists"
},
{
 "tagName": "ul",
 "tagValue": "<ul></ul>",
 "TagComment": "Defines an unordered list",
 "TagType": "Lists"
},
{
 "tagName": "ol",
 "tagValue": "<ol></ol>",
 "TagComment": "Defines an ordered list",
 "TagType": "Lists"
},
{
 "tagName": "li",
 "tagValue": "<li></li>",
 "TagComment": "Defines a list item",
 "TagType": "Lists"
},
{
 "tagName": "dl",
 "tagValue": "<dl></dl>",
 "TagComment": "Defines a description list",
 "TagType": "Lists"
},
{
 "tagName": "dt",
 "tagValue": "<dt></dt>",
 "TagComment": "Defines a term/name in a description list",
 "TagType": "Lists"
},
{
 "tagName": "dd",
 "tagValue": "<dd></dd>",
 "TagComment": "Defines a description of a term/name in a description list",
 "TagType": "Lists"
},
{
 "tagName": "table",
 "tagValue": "<table></table>",
 "TagComment": "Defines a table",
 "TagType": "Tables"
},
{
 "tagName": "caption",
 "tagValue": "<caption></caption>",
 "TagComment": "Defines a table caption",
 "TagType": "Tables"
},
{
 "tagName": "th",
 "tagValue": "<th></th>",
 "TagComment": "Defines a header cell in a table",
 "TagType": "Tables"
},
{
 "tagName": "tr",
 "tagValue": "<tr></tr>",
 "TagComment": "Defines a row in a table",
 "TagType": "Tables"
},
{
 "tagName": "td",
 "tagValue": "<td></td>",
 "TagComment": "Defines a cell in a table",
 "TagType": "Tables"
},
{
 "tagName": "thead",
 "tagValue": "<thead></thead>",
 "TagComment": "Groups the header content in a table",
 "TagType": "Tables"
},
{
 "tagName": "tbody",
 "tagValue": "<tbody></tbody>",
 "TagComment": "Groups the body content in a table",
 "TagType": "Tables"
},
{
 "tagName": "tfoot",
 "tagValue": "<tfoot></tfoot>",
 "TagComment": "Groups the footer content in a table",
 "TagType": "Tables"
},
{
 "tagName": "col",
 "tagValue": "<col>",
 "TagComment": "Specifies column properties for each column within a <colgroup> element",
 "TagType": "Tables"
},
{
 "tagName": "colgroup",
 "tagValue": "<colgroup></colgroup>",
 "TagComment": "Specifies a group of one or more columns in a table for formatting",
 "TagType": "Tables"
},
{
 "tagName": "style",
 "tagValue": "<style></style>",
 "TagComment": "Defines style information for a document",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "div",
 "tagValue": "<div></div>",
 "TagComment": "Defines a section in a document",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "span",
 "tagValue": "<span></span>",
 "TagComment": "Defines a section in a document",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "header",
 "tagValue": "<header></header>",
 "TagComment": "Defines a header for a document or section",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "hgroup",
 "tagValue": "<hgroup></hgroup>",
 "TagComment": "Defines a header and related content",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "footer",
 "tagValue": "<footer></footer>",
 "TagComment": "Defines a footer for a document or section",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "main",
 "tagValue": "<main></main>",
 "TagComment": "Specifies the main content of a document",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "section",
 "tagValue": "<section></section>",
 "TagComment": "Defines a section in a document",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "search",
 "tagValue": "<search></search>",
 "TagComment": "Defines a search section",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "article",
 "tagValue": "<article></article>",
 "TagComment": "Defines an article",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "aside",
 "tagValue": "<aside></aside>",
 "TagComment": "Defines content aside from the page content",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "details",
 "tagValue": "<details></details>",
 "TagComment": "Defines additional details that the user can view or hide",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "dialog",
 "tagValue": "<dialog></dialog>",
 "TagComment": "Defines a dialog box or window",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "summary",
 "tagValue": "<summary></summary>",
 "TagComment": "Defines a visible heading for a <details> element",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "data",
 "tagValue": "<data></data>",
 "TagComment": "Adds a machine-readable translation of a given content",
 "TagType": "Styles and Semantics"
},
{
 "tagName": "meta",
 "tagValue": "<meta>",
 "TagComment": "Defines metadata about an HTML document",
 "TagType": "Meta Info"
},
{
 "tagName": "base",
 "tagValue": "<base>",
 "TagComment": "Specifies the base URL/target for all relative URLs in a document",
 "TagType": "Meta Info"
},
{
 "tagName": "scrip",
 "tagValue": "<scrip></scrip>",
 "TagComment": "Defines a client-side script",
 "TagType": "Programming"
},
{
 "tagName": "noscript",
 "tagValue": "<noscript></noscript>",
 "TagComment": "Defines an alternate content for users that do not support client-side scripts",
 "TagType": "Programming"
},
{
 "tagName": "embed",
 "tagValue": "<embed></embed>",
 "TagComment": "Defines a container for an external (non-HTML) application",
 "TagType": "Programming"
},
{
 "tagName": "object",
 "tagValue": "<object></object>",
 "TagComment": "Defines an embedded object",
 "TagType": "Programming"
},
{
 "tagName": "param",
 "tagValue": "<param>",
 "TagComment": "Defines a parameter for an object",
 "TagType": "Programming"
}
];


function buildTable() {
        const tableBody = document.getElementById('tagsTable').getElementsByTagName('tbody')[0];
        tags.forEach((tag, index) => {
            let row = tableBody.insertRow();
            row.onclick = function(event) { chooseTag(index,event); };

            let tagNameCell = row.insertCell(0);
            let tagValueCell = row.insertCell(1);
            let tagTypeCell = row.insertCell(2);
            let tagCommentCell = row.insertCell(3);

            tagNameCell.textContent = tag.tagName;
            tagValueCell.textContent = tag.tagValue;
            tagTypeCell.textContent = tag.TagType;
            tagCommentCell.textContent = tag.TagComment;
        });
    }
    function filterTable(column) {
      let input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("tagsTable").getElementsByTagName("thead")[0].getElementsByTagName("input")[column];
      filter = input.value.toUpperCase();
      table = document.getElementById("tagsTable");
      tr = table.getElementsByTagName("tr");

      for (i = 2; i < tr.length; i++) {
          td = tr[i].getElementsByTagName("td")[column];
          if (td) {
              txtValue = td.textContent || td.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                  tr[i].style.display = "";
              } else {
                  tr[i].style.display = "none";
              }
          }
      }
  }
    function chooseTag(index,event) {
      console.log('in')
      console.log(event)
      let chosenTag = tags[index];
      //alert("Chosen Tag Name: " + chosenTag.tagName + "\nChosen Tag Value: " + chosenTag.tagValue);

      // Get the fieldset attributes
      const fieldset = event.currentTarget.closest('fieldset');
      if (fieldset) {
        const fieldsetId = fieldset.id;
        const fieldsetAction = fieldset.getAttribute('action');
        console.log("Fieldset ID:", fieldsetId);
        console.log("Fieldset Action:", fieldsetAction);
        const el =    
        {
            time: (new Date()).getTime(),
            action:fieldsetAction,
            target_element:fieldsetId.split(';')[1],

          }
          if(fieldsetAction === 'ChangeTag'){
            el.tag_change = chosenTag.tagValue
          }
          else {
            el.inserted_element = {type:'tag',tag:'chosenTag.tagValue',id:generateUUID()}
          }
          pushAction(el)
      }
    }

    window.onload = buildTable;    </script>
</code-builder>



  <style>
    .highlight-left-border {
        border-left-color: blue;
    } 
    .highlight-left-border-red {
        border-left-color: red; 
    }
    </style>
<script>
  document.querySelectorAll('button[data-element="code-tree-show-hide-button"]').forEach(button => {
      button.addEventListener('mouseover', function() {
          let currentFieldset = this.closest('[data-element="code-tree-tag"]');
          
          Array.from(currentFieldset.parentElement.children).forEach(sibling => {
              if (sibling.getAttribute('data-element') === 'code-tree-tag') {
                  sibling.classList.add('highlight-left-border-red');
              }
          });

          Array.from(currentFieldset.children).forEach(child => {
              if (child.getAttribute('data-element') === 'code-tree-tag') {
                  child.classList.add('highlight-left-border');
              }
          });
      });

      button.addEventListener('mouseout', function() {
          let currentFieldset = this.closest('[data-element="code-tree-tag"]');

          Array.from(currentFieldset.parentElement.children).forEach(sibling => {
              if (sibling.getAttribute('data-element') === 'code-tree-tag') {
                  sibling.classList.remove('highlight-left-border-red');
              }
          });

          Array.from(currentFieldset.children).forEach(child => {
              if (child.getAttribute('data-element') === 'code-tree-tag') {
                  child.classList.remove('highlight-left-border');
              }
          });
      });
  });
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var textarea = document.getElementById('code-tree-inner-html-receive-textarea');
    
    textarea.addEventListener('input', function() {
        // Expand height
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';

        // Expand width
        var mirrorDiv = document.getElementById('mirror-div');
        if (!mirrorDiv) {
            mirrorDiv = document.createElement('div');
            mirrorDiv.id = 'mirror-div';
            document.body.appendChild(mirrorDiv);
        }

        mirrorDiv.style.display = 'inline-block';
        mirrorDiv.textContent = this.value.replace(/\n/g, '<br/>');
        this.style.width = Math.min(this.parentElement.offsetWidth, mirrorDiv.offsetWidth + 10) + 'px'; // 10px for some padding
        mirrorDiv.style.display = 'none';
    });
});
</script>

<!--aside toggle-->
<script>document.getElementById('aside-toggle').addEventListener('click', function() {
  var btn = document.getElementById('aside-toggle');
  var grid = document.getElementById('content-grid');

  // Check the current state and toggle
  if (btn.innerHTML === '←log') {
      btn.innerHTML = 'log→';
      grid.style.gridTemplateColumns = '80% 20%';
  } else {
      btn.innerHTML = '←log';
      grid.style.gridTemplateColumns = '100% 0%';
  }
});
</script>

<!--add comment style-->
<style>
  [data-action="code-tree-tag-comment-add"] {
display: inline-block; /* Ensures transform applies */
user-select: none; /* Disables text selection */
}

[data-action="code-tree-tag-comment-add"]:hover {
/* Scale the element up slightly on hover */
transform: scale(1.3); /* Adjust the scale value as needed */
cursor: pointer;
transition: transform 0.2s ease; /* Smooth transition for the scaling effect */
}
.pressed {
/* Define your pressed state styles here */
transform: scale(0.95); /* Example pressed effect */
}
</style>

